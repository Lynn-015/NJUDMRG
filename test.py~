from __future__ import division

import numpy as np
from scipy.sparse.linalg import eigsh

from hgen import LHGen,RHGen
from dmrg import DMRGEngine
from operator import SpinOp,BoseOp,SpinTerm,BoseTerm,Sp,Sm,Sz,cdag,c,n

J=0.1
#Sp=np.array([[0,1],[0,0]])
#Sm=np.array([[0,0],[1,0]])
#Sz=np.array([[1,0],[0,-1]])*0.5

sterms=[SpinTerm(op1=Sp,op2=Sm,param=J/2),SpinTerm(op1=Sm,op2=Sp,param=J/2),SpinTerm(op1=Sz,op2=Sz,param=J)]

lhgen=LHGen(sterms,2)
rhgen=RHGen(sterms,2,10)

def test_spin_idmrg():
	dmrg=DMRGEngine(lhgen,rhgen)
	dmrg.infinite(m=10)

def test_spin_fdmrg():
	dmrg=DMRGEngine(lhgen,rhgen)
	dmrg.finite(mwarmup=10,mlist=[10,20,30,40])

#def test_bose_idmrg():

#def test_bose_fdmrg():

if __name__=='__main__':
	#test_spin_idmrg()
	test_spin_fdmrg()
